Log notice syslog
RunAsDaemon 1
DataDirectory {{ datadir }}

{% if instance.relay | default({}) %}
Address {{ ansible_nodename }}
Nickname {{ instance.relay.nickname }}
ContactInfo {{ instance.relay.contactinfo }}
MyFamily {{ tor_relay_family | join(",") }}

ExitPolicy reject *:*

ORPort 443 NoListen
ORPort 9090 NoAdvertise
{% if instance.relay.v6ip is defined %}
ORPort [{{ instance.relay.v6ip }}]:443 NoListen
ORPort [{{ instance.relay.v6ip }}]:9090 NoAdvertise
{% endif %}

DirPort 80 NoListen
DirPort 9091 NoAdvertise

ControlPort 9051
{% endif %}

{% for os in instance.onion_services | default([]) %}
HiddenServiceDir {{ datadir }}/{{ os.name }}/
HiddenServicePort {{ os.hidden_service_port }}

{% endfor %}{% endif %}

{% if instance.onion_client_auths | default({}) %}
ClientOnionAuthDir {{ datadir }}/onion_client_auths
{% endif %}
